@model Benner.Microondas.Site.Models.MicroondasModel

@{
  ViewBag.Title = "Microondas Online";
}

<div class="row">
    <div class="col-md-12">
        <h3>Esquentar meu rango agora!</h3>
    </div>
</div>

<div class="row col-md-12">
    @using (Html.BeginForm("Esquentar", "Microondas", FormMethod.Post))
    {
        @Html.TextBoxFor(x => x.Rapido, new { Type = "hidden" })

    <div class="form-group">
        @Html.LabelFor(x => x.Tempo, new { Value = "Tempo de Cozimento" })
        @Html.TextBoxFor(x => x.Tempo, new { Class = "form-control", Type = "time", Step = "2", Autocomplete = "off" })
    </div>

    <div class="form-group">
        @Html.ValidationMessageFor(x => x.Potencia, null, new { Class = "control-label" })
        @Html.LabelFor(x => x.Potencia, new { Text = "Potência" })
        @Html.TextBoxFor(x => x.Potencia, new { Class = "form-control", Type = "number", Value = 10, Autocomplete = "off" })
    </div>

    @Html.Raw(HttpUtility.HtmlDecode(Html.ValidationMessage("MicroondasErro").ToString()))
        if (ViewData.ModelState.Values.Count > 0)
        {
            string msg = string.Join(";  ", ViewData.ModelState.Values.SelectMany(x => x.Errors).Select(x => x.ErrorMessage));

        <div class="alert alert-dismissible alert-danger">
            <button type="button" class="close" data-dismiss="alert">&times;</button>
            <strong>Ooops!</strong><br />@msg
        </div>
        }

    <div class="form-group">
        <button type="submit" id="Iniciar" class="btn btn-warning btn-block">Iniciar</button>
        <button type="submit" id="InicioRapido" class="btn btn-info btn-block">Início Rápido</button>
    </div>
    }
</div>

<div id="progresso" style="font-size: 30px; font-weight: bold;"></div>


@section Scripts
{
    <script type="text/javascript">
        $('#InicioRapido').on('click', function (evt) {
            $('#Rapido').val(true);
        });

        //$('#Iniciar').on('click', function (evt) {
        //    evt.preventDefault();
        //    $('#progresso').empty();

        //    var tempo = $('#Tempo').val();
        //    var potencia = $('#Potencia').val();

        //    $.get('/microondas/aquecimento', { rapido: false, tempo: tempo, potencia: potencia }, function (msg) {
        //        window.clearInterval(intervalId);
        //        $('#progresso').html("Aquecido!");
        //    });

        //    var intervalId = window.setInterval(function () {
        //        $.getJSON('/microondas/aquecimentoprogress', { id: potencia }, function (json) {
        //            $('#progresso').append(json.Progress);
        //        });
        //    }, 1000);
        //});
        
    </script>
}
